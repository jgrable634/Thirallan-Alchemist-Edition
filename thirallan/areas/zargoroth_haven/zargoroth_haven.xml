<?xml version="1.0" encoding="utf-8" ?>
<areas>

  <include id="parallax/parallax.xml" />

  <area id="thirallan_zargoroth" background="thirallan_zargoroth" width="150" height="100" name="world.thirallan_zargoroth" planet="thirallan_alchemist">
    <shore x="-1" top="sand_top" bottom="sand" trans1="dirt_sand2" trans2="dirt_sand1" flip="true" dock="dock_empty" height="96" />
    <shore x="150" top="sand_top" bottom="sand" dock="dock_empty_flip" trans1="dirt_sand1" trans2="dirt_sand2" />
    <tiles id="dirt" start="0" end="0.5" />
    <tiles id="stone" start="0.5" end="1" />
    <tiles id="grass" y="0" />
    <tiles id="blackstone" y="99" />
    <ore id="quartz" start="0.4" end="0.5" percent="0.0025" tile="dirt" />
    <ore id="iron" start="0.2" end="0.5" percent="0.0125" tile="dirt" />
    <ore id="iron" start="0.1" end="0.2" percent="0.000625" tile="dirt" />
    <ore id="coal" start="0.0" end="0.4" percent="0.0375" tile="dirt" />
    <ore id="gold" start="0.4" end="0.5" percent="0.000625" tile="dirt" />
    <ore id="diamond" start="0.9" end="1.0" percent="0.0025" tile="stone" />
    <ore id="gold" start="0.5" end="1.0" percent="0.0125" tile="stone" />
    <ore id="malumite_ore" start="0.5" end="0.9" percent="0.0375" tile="stone" />
    <ore id="lava" start="0.7" end="0.8" percent="1" tile="stone" />
    <objects id="tree" y="-1" startX="0" endX="50" minDist="6" maxDist="6" array="left" />
    <objects id="tree" y="-1" startX="100" endX="150" minDist="6" maxDist="6" array="right" />
    <structure id="hut" x="60" y="-1" />
    <structure id="storehouse" x="70" y="-1" />
    <structure id="kitchen2" x="80" y="-1" />
    <structure id="thirallan_zargoroth.mines" x="90" y="-1" />
    <object id="peredur" x="25" y="-1" />
    <object id="zargoroth_npc" x="55" y="-1" />
    <object id="pyrrhos" x="75" y="-1" />
    <object id="tomkin" x="60" y="-1" />
    <appendArea id="sea_floor"><params area_left="-250" area_right="330" area_width="150" area_height="100" /></appendArea>
    <objects id="undead" fromX="0" toX="150" fromY="-1" toY="-1" count="6" />
    <spawner id="undead" time="100" count="3" fromX="0" toX="150" fromY="-1" toY="-1" enabled="!getFlag('blood_moon')" />
    <spawner id="corrupted_spider" time="200" count="3" fromX="0" toX="150" fromY="-1" toY="-1" enabled="isNight()" />
    <spawner id="blood_zombie" time="100" count="2" fromX="0" toX="150" fromY="-1" toY="-1" enabled="getFlag('blood_moon')" />
    <spawner id="floating_blood" time="100" count="2" fromX="0" toX="150" fromY="-1" toY="-3" enabled="getFlag('blood_moon')" ground="false" />
    <init><runAreaLoad /></init>
    <onLoad>
      <section if="!getFlag('blood_moon')">
        <music id="magic2" seconds="1" />
        <weather type="fog" alpha="1" color="1F2A1F" x="-50" y="0" width="250" height="25" dx="0.3" dy="0.3" />
      </section>
      <section if="getFlag('blood_moon')">
        <music id="purified_encounter" seconds="1" />
        <weather type="fog" alpha="0.75" color="5C0000" x="-50" y="0" width="250" height="25" dx="0.3" dy="0.3" />
      </section>
      <section if="(player.hasQuest('purifiers_side') || player.hasQuest('UC_side')) && !getFlag('martians_dead')">
        <remove object="area.getObject('guard_chief')" />
        <remove object="area.getObject('pyrrhos')" />
        <run procedure="unknown_start" />
      </section>
      <section if="!isNight() && player.questComplete('blood_moon')">
        <run procedure="check_blood_moon" />
      </section>
      <appendArea id="sea_floor" if="area.getObject('seaweed') == null"><params area_left="-250" area_right="330" area_width="192" area_height="96" /></appendArea>
      <action if="area.getTileString(-5, 33, BASE_LAYER) != 'blackstone'">for(x in -5...0) setTile(x, 33, "blackstone")</action>
      <action if="area.getTileString(-5, 41, BASE_LAYER) != 'blackstone'">for(x in -5...0) setTile(x, 41, 'blackstone'); for(y in 33...41) setTile(-2, y, 'blackstone');</action>
    </onLoad>
  </area>

  <area id="jacominus_rest" width="20" height="30">
    <tiles id="fuck_off_stone" start="0" end="1" />
    <action>
      for(x in 1...20) for(y in 19...30) mine(x,y);
      for(x in 1...20) for(y in 1...13) mine(x,y);
      for(y in 13...20) mine(10,y);
    </action>
    <object id="jacominus" x="10" y="3" />
  </area>

  <area id="thirallan_zargoroth.mines" width="50" height="100">
    <structure id="thirallan_zargoroth.mines.ret" x="1" y="15" />
    <structure id="undead_shrine" x="40" y="75" />
    <action>
      setBack(1, 27, "fuck_off_stone"); setBack(2, 27, "fuck_off_stone"); setBack(1, 28, "fuck_off_stone"); setBack(2, 28, "fuck_off_stone");
      dy = random()>0.5?1:30; for(y in 0...10) for(x in 30...40) setBack(x, y+dy, "fuck_off_stone");
    </action>
    <maze floor="fuck_off_stone" wall="blackstone" width="30" height="99" />
    <appendArea id="jacominus_rest" offsetX="30" offsetY="30" />
    <action>
      for(x in 30...49) for(y in 1...99){setTile(x,y,"fuck_off_stone"); setBack(x,y,"fuck_off_stone"); mine(x,y);}
      for(x in 30...49){setTile(x,0,"blackstone"); setTile(x,99,"blackstone");} for(y in 0...100) setTile(49,y,"blackstone");
      for(x in 31...48) for(y in 19...30) mine(x,y);
      for(x in 31...48) for(y in 1...13) mine(x,y);
      for(y in 13...20) mine(40,y);
      for(y in 1...98) mine(29,y);
    </action>
    <objects id="undead_shrineDefender" count="7" fromX="30" toX="49" fromY="80" toY="99" />
  </area>


</areas>
